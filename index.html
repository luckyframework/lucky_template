<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 1.7.3">
<meta name="crystal_docs.project_version" content="master">
<meta name="crystal_docs.project_name" content="lucky_template">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="lucky_template">
  <title>lucky_template master</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          lucky_template
        </a>
      </h1>

      <span class="project-version">
        master
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class="parent " data-id="lucky_template/LuckyTemplate" data-name="luckytemplate">
      <a href="LuckyTemplate.html">LuckyTemplate</a>
      
        <ul>
  
  <li class=" " data-id="lucky_template/LuckyTemplate/Error" data-name="luckytemplate::error">
      <a href="LuckyTemplate/Error.html">Error</a>
      
    </li>
  
  <li class=" " data-id="lucky_template/LuckyTemplate/Fileable" data-name="luckytemplate::fileable">
      <a href="LuckyTemplate/Fileable.html">Fileable</a>
      
    </li>
  
  <li class=" " data-id="lucky_template/LuckyTemplate/FileIO" data-name="luckytemplate::fileio">
      <a href="LuckyTemplate/FileIO.html">FileIO</a>
      
    </li>
  
  <li class=" " data-id="lucky_template/LuckyTemplate/FileSystem" data-name="luckytemplate::filesystem">
      <a href="LuckyTemplate/FileSystem.html">FileSystem</a>
      
    </li>
  
  <li class=" " data-id="lucky_template/LuckyTemplate/Folder" data-name="luckytemplate::folder">
      <a href="LuckyTemplate/Folder.html">Folder</a>
      
    </li>
  
  <li class=" " data-id="lucky_template/LuckyTemplate/Snapshot" data-name="luckytemplate::snapshot">
      <a href="LuckyTemplate/Snapshot.html">Snapshot</a>
      
    </li>
  
  <li class=" " data-id="lucky_template/LuckyTemplate/Spec" data-name="luckytemplate::spec">
      <a href="LuckyTemplate/Spec.html">Spec</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1><a id="lucky-template" class="anchor" href="#lucky-template">  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>LuckyTemplate</h1>
<p><a href="https://github.com/mdwagner/lucky_template/actions/workflows/ci.yml"><img src="https://github.com/mdwagner/lucky_template/actions/workflows/ci.yml/badge.svg" alt="CI" /></a></p>
<p><a href="https://github.com/mdwagner/lucky_template">LuckyTemplate</a> is a simple, yet versatile, library for creating file and folder structures as code templates. It has a lot in common with <a href="https://github.com/mosop/teeplate">Teeplate</a>, but it offers more capabilities and more ways to generate content.</p>
<h2><a id="features" class="anchor" href="#features">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Features</h2>
<ul>
<li>Allows you to create a virtual file/folder structure, which can be written to disk anywhere.</li>
<li>Supports using folders like building blocks, allowing you to reuse folders within other folders.</li>
<li>File content can be static or dynamic</li>
<li>Includes a Spec helper to validate that the files/folders within a location exist after writing to disk.</li>
<li>Provides a snapshot of a folder structure for custom validation or for any other purpose like generating log output.</li>
</ul>
<h2><a id="installation" class="anchor" href="#installation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installation</h2>
<ol>
<li>Add the dependency to your <code>shard.yml</code>:</li>
</ol>
<pre><code class="language-yaml">dependencies:
  lucky_template:
    github: mdwagner/lucky_template</code></pre>
<ol start="2">
<li>Run <code>shards install</code></li>
</ol>
<h2><a id="quick-start" class="anchor" href="#quick-start">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Quick Start</h2>
<p>Here's a basic example of how to use LuckyTemplate:</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;lucky_template&quot;</span>

<span class="t">LuckyTemplate</span>.write!(<span class="t">Path</span>[<span class="s">&quot;.&quot;</span>]) <span class="k">do</span> <span class="o">|</span>folder<span class="o">|</span>
<span class="k">end</span></code></pre>
<p>This will create an empty folder at the current directory. See the sections below for more complex examples.</p>
<h2><a id="examples" class="anchor" href="#examples">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Examples</h2>
<h3><a id="simple-template" class="anchor" href="#simple-template">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Simple Template</h3>
<p>In this example, we create a simple README file using an ECR template, a welcome file, and a license file. We also create a new file and folder dynamically in a subfolder.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;lucky_template&quot;</span>

<span class="k">class</span> <span class="t">Readme</span>
  <span class="k">include</span> <span class="t">LuckyTemplate</span><span class="t">::</span><span class="t">Fileable</span>

  <span class="k">def</span> <span class="m">initialize</span>(@name : <span class="t">String</span>)
  <span class="k">end</span>

  <span class="k">def</span> <span class="m">to_file</span>(io : <span class="t">IO</span>) : <span class="t">Nil</span>
    to_s(io)
  <span class="k">end</span>

  <span class="t">ECR</span>.def_to_s <span class="s">&quot;README.md.ecr&quot;</span>
<span class="k">end</span>

name <span class="o">=</span> <span class="s">&quot;John&quot;</span>
folder <span class="o">=</span> <span class="t">LuckyTemplate</span>.write!(<span class="t">Path</span>[<span class="s">&quot;.&quot;</span>]) <span class="k">do</span> <span class="o">|</span>dir<span class="o">|</span>
  dir.add_file(<span class="s">&quot;README.md&quot;</span>, <span class="t">Readme</span>.new(name))

  dir.add_file(<span class="s">&quot;Welcome.md&quot;</span>) <span class="k">do</span> <span class="o">|</span>io<span class="o">|</span>
    io <span class="o">&lt;&lt;</span> <span class="s">&quot;# Welcome &quot;</span> <span class="o">&lt;&lt;</span> name <span class="o">&lt;&lt;</span> <span class="s">&quot;!\n&quot;</span>
  <span class="k">end</span>

  dir.add_file(<span class="s">&quot;LICENSE&quot;</span>, <span class="s">&lt;&lt;-LICENSE</span>)
<span class="s">  The MIT License (MIT)
  ...
  LICENSE</span>

  dir.add_folder(<span class="s">&quot;src&quot;</span>) <span class="k">do</span> <span class="o">|</span>src<span class="o">|</span>
    src.add_file(<span class="s">&quot;.keep&quot;</span>)

    src.add_folder(name.downcase) <span class="k">do</span> <span class="o">|</span>name_dir<span class="o">|</span>
      name_dir.add_file(<span class="s">&quot;</span><span class="i">#{</span>name.downcase<span class="i">}</span><span class="s">.cr&quot;</span>, <span class="s">&lt;&lt;-CR</span>)
<span class="s">      class </span><span class="i">#{</span>name<span class="i">}</span><span class="s">
      end

      pp! </span><span class="i">#{</span>name<span class="i">}</span><span class="s">.new
      CR</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
<h3><a id="creating-multiple-folders" class="anchor" href="#creating-multiple-folders">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Creating Multiple Folders</h3>
<p>You can also create multiple folders at once or nest them within other folders:</p>
<pre><code class="language-crystal">folder1 <span class="o">=</span> <span class="t">LuckyTemplate</span>.create_folder <span class="k">do</span> <span class="o">|</span>dir<span class="o">|</span>
  dir.add_file(<span class="s">&quot;folder_one.txt&quot;</span>)
<span class="k">end</span>
folder2 <span class="o">=</span> <span class="t">LuckyTemplate</span>.create_folder <span class="k">do</span> <span class="o">|</span>dir<span class="o">|</span>
  dir.add_file(<span class="s">&quot;folder_two.txt&quot;</span>)
<span class="k">end</span>
folder3 <span class="o">=</span> <span class="t">LuckyTemplate</span>.create_folder <span class="k">do</span> <span class="o">|</span>dir<span class="o">|</span>
  dir.add_file(<span class="s">&quot;folder_three.txt&quot;</span>)
  dir.insert_folder(<span class="s">&quot;folder1&quot;</span>, folder1)
  dir.insert_folder(<span class="s">&quot;folder2&quot;</span>, folder2)
<span class="k">end</span>
<span class="t">LuckyTemplate</span>.write!(<span class="t">Path</span>[<span class="s">&quot;.&quot;</span>], folder3)</code></pre>
<h3><a id="snapshot-folders" class="anchor" href="#snapshot-folders">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Snapshot Folders</h3>
<p>Another great feature is that you can take snapshots of folder structures:</p>
<pre><code class="language-crystal">snapshot <span class="o">=</span> <span class="t">LuckyTemplate</span>.snapshot(folder3)

snapshot.each <span class="k">do</span> <span class="o">|</span>path, <span class="k">type</span><span class="o">|</span>
  <span class="k">case</span> <span class="k">type</span>
  <span class="k">in</span> .file?
    puts <span class="s">&quot;File: </span><span class="i">#{</span>path<span class="i">}</span><span class="s">&quot;</span>
  <span class="k">in</span> .folder?
    puts <span class="s">&quot;Folder: </span><span class="i">#{</span>path<span class="i">}</span><span class="s">&quot;</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
<h3><a id="using-non-crystal-templates" class="anchor" href="#using-non-crystal-templates">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Using Non-Crystal Templates</h3>
<p>If you prefer to use another template engine besides Crystal's, you can do so by creating a running process, as shown in the following example with gettext <code>envsubst</code>:</p>
<pre><code class="language-crystal"><span class="k">class</span> <span class="t">ExternalTemplate</span>
  <span class="k">include</span> <span class="t">LuckyTemplate</span><span class="t">::</span><span class="t">Fileable</span>

  <span class="k">def</span> <span class="m">initialize</span>(@name : <span class="t">String</span>)
  <span class="k">end</span>

  <span class="k">def</span> <span class="m">to_file</span>(io : <span class="t">IO</span>) : <span class="t">Nil</span>
    input <span class="o">=</span> <span class="t">IO</span><span class="t">::</span><span class="t">Memory</span>.new(<span class="s">&quot;Hello $NAME!&quot;</span>)
    <span class="t">Process</span>.run(
      command: <span class="s">&quot;envsubst&quot;</span>,
      input: input,
      output: io,
      env: {
        <span class="s">&quot;NAME&quot;</span> <span class="o">=&gt;</span> @name,
      }
    )
  <span class="k">end</span>
<span class="k">end</span>

<span class="t">LuckyTemplate</span>.write!(<span class="t">Path</span>[<span class="s">&quot;.&quot;</span>]) <span class="k">do</span> <span class="o">|</span>dir<span class="o">|</span>
  dir.add_file(<span class="s">&quot;external_file&quot;</span>, <span class="t">ExternalTemplate</span>.new(<span class="s">&quot;John&quot;</span>))
<span class="k">end</span></code></pre>
<h2><a id="faq" class="anchor" href="#faq">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>FAQ</h2>
<ul>
<li>Why create this if Teeplate already exists? Initially, I tried to add Windows support to Teeplate, but ran into some issues, that prompted me to just ask the question: Is this effort worth it? <a href="https://github.com/luckyframework/lucky/discussions/1812">This discussion</a> gave me the push I needed to create a POC (proof-of-concept), which this library is the result of.</li>
<li>Does it support Windows? Yes, it runs the spec suite on Linux &amp; Windows.</li>
<li>Why do folder snapshots not contain the file content? Because I haven't found a good enough use-case to support this. Snapshots are supposed to be an escape hatch, where you can get the file/folder structure, but decide what you would like to do with it. Having it include file content doesn't really make sense when LuckyTemplate already writes it to disk for you. But, if you have a good use-case that I haven't thought of, open an issue!</li>
<li>Can I use it with <code>crinja</code>, <code>kilt</code>, <code>slang</code>, <insert templating language>...? Yes, or at least, that's the goal! If you find it doesn't work with something, open an issue.</li>
</ul>
<h2><a id="contributing" class="anchor" href="#contributing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributing</h2>
<ol>
<li>Fork it (<a href="https://github.com/mdwagner/lucky_template/fork">https://github.com/mdwagner/lucky_template/fork</a>)</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create a new Pull Request</li>
</ol>
<h2><a id="contributors" class="anchor" href="#contributors">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributors</h2>
<ul>
<li><a href="https://github.com/mdwagner">Michael Wagner</a> - creator and maintainer</li>
</ul>
</div>
</body>
</html>
